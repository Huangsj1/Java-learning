Nacos是Alibaba的产品，现属于SpringCloud的组件，比Eureka功能更多

* Eureka可以通过新建一个maven模块来作为新的服务启动
* Nacos需要下载安装来启动

# 一、下载配置

1. 在github[Releases · alibaba/nacos (github.com)](https://github.com/alibaba/nacos/releases?page=1)下载对应版本并解压
2. 启动：命令行在 `bin/` 目录下执行 `startup.cmd -m standalone` 单机启动
	* 启动后进入页面登录用户名密码默认都为 `nacos`，进入后就可以看到注册的服务
3. 配置：配置文件在 `conf/application.properties` 中，可以修改端口号

# 二、服务注册

![[Pasted image 20240222173519.png]]![[Pasted image 20240222173530.png]]

# 三、服务分级模型

![[a0331122dbca7bec7cc4f3345185fbc.jpg]]

## 1. 设置所属集群

![[29637d1a30ffd247c42aba30ee5ad26.jpg]]

![[Pasted image 20240222174141.png]]

## 2. 负载均衡选择集群

配置ribbon负载均衡即可**优先选择同一集群**，本地集群没有才选择其他集群（同意集群内**随机选择**）

![[f6d414a9b43217410eaaafd42ffaf78.jpg]]

### 修改权重

在Nacos控制台/页面中可以设置实例权重在 0~1 之间，0则不会被访问

# 四、环境隔离

可以通过**命名空间Namespace**来进行服务的隔离

![[e39ca7016f84838fd04b32054b874a3.jpg]]

默认这些服务都是在public命名空间中的，每隔命名空间都有一个唯一的id，**不同命名空间的服务不可见**

![[Pasted image 20240222175834.png]]![[Pasted image 20240222175841.png]]![[Pasted image 20240222175846.png]]![[Pasted image 20240222175856.png]]![[Pasted image 20240222175906.png]]

# 五、与Eureaka的区别

![[2575ebfa47ec86132d0876499b78e72.jpg]]

与Eureka不同：

1. 服务分为**临时实例和非临时实例**
	1. 临时实例：同eureka一样采用心跳监测，服务定期发送请求，若无心跳就**丢弃**该服务
	2. 非临时实例：nacos注册中心主动询问服务，若无响应只是**停止**该服务
2. nacos注册中心中如果有服务停止，会**主动push推送变更消息**给消费者，服务缓存列表更新更及时

![[Pasted image 20240222181334.png]]