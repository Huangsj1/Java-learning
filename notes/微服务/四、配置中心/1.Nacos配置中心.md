由于服务的一些配置信息是会改变的，所以需要通过**统一配置管理**来管理这些配置信息，**实现热/实时更新**

![[Pasted image 20240223092242.png]]

# 一、基本使用

## 1. Nacos添加配置信息

配置管理中配置的是会改变的，需要热更新的配置信息

![[b5dd494800abb239a1048972fa8670e.jpg]]![[819a74f5d6930c59569bf0db28616bd.jpg]]

## 2. 项目的模块引入依赖并使用

![[2a1a4304d4137ddd2d60528d31a0ebc.jpg]]![[1dad56482278c361931726c60d0c7d5.jpg]]

## 总结

![[Pasted image 20240223092327.png]]

# 二、自动刷新

当配置中心配置文件发生变化时会主动发送通知给用到的服务，但是服务需要主动获取动态刷新用到的变量的值就需要进行动态刷新的配置，有以下两种方法：

![[dce28aa82dce0908511cf4d32332da3.jpg]]![[Pasted image 20240223093214.png]]

## 总结

![[Pasted image 20240223093240.png]]

# 三、多环境配置共享

由于不同的环境（例如：开发dev、生产prod、测试test等）可能有相同的配置信息，分别配置和修改太麻烦，所以需要配置它们**共享的配置信息**

![[4b47da0e10da888e54e7f1053003212.jpg]]

优先级：

![[Pasted image 20240223093949.png]]

## 总结

![[Pasted image 20240223093958.png]]

# 四、Nacos集群搭建

![[Pasted image 20240223095501.png|400]]

配置并运行多个Nacos来实现集群，并通过nginx的反向代理来负载均衡选择nacos（nginx的负载均衡是**选择不同的nacos服务**），步骤如下：

1. 搭建MySQL集群并初始化数据库表（Nacos会将配置文件写入该数据库表中，这样其他nacos就会从数据库中读取同时修改配置文件）
2. 下载解压Nacos，在配置文件 `cluster.conf` 中修改集群配置信息、配置文件 `application.properties` 中进行数据库配置
3. 将Nacos文件夹复制成多份并都执行`startup.cmd`命令来启动（如果是在同一台电脑上那么每份需要分别配置对应的端口信息）
4. 配置nginx添加nacos负载均衡选择，并实现反向代理跳转到nacos地址，运行nginx
5. 之后访问nginx就会负载均衡跳转到其中一个nacos服务中
6. 项目服务中若需要访问集群，需要修改访问的nacos的地址为nginx地址，这样就能通过nginx跳转到对应的nacos中
